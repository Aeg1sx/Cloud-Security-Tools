rules:
  - id: nodejs.security.diagnostics-channel.internalworker-leak-23083
    metadata:
      category: security
      cwe: CWE-284
      cvss: CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
      references:
        - https://nvd.nist.gov/vuln/detail/CVE-2025-23083
        - https://nodejs.org/en/blog/vulnerability/january-2025-security-releases#worker-permission-bypass-via-internalworker-leak-in-diagnostics-cve-2025-23083-high
        - https://security.snyk.io/vuln/SNYK-UNMANAGED-NODEJSNODE-8650498
        - https://access.redhat.com/security/cve/cve-2025-23083
        - https://security.netapp.com/advisory/ntap-20250228-0008/
        - https://www.suse.com/security/cve/CVE-2025-23083.html
    severity: HIGH
    message: Worker permission bypass via InternalWorker leak using
      diagnostics_channel â€“ CVE-2025-23083
    languages:
      - javascript
    patterns:
      - pattern: |
          require('diagnostics_channel')
            .channel($CHANNEL_NAME)
            .subscribe($CALLBACK)
    fix: >
      Restrict diagnostics_channel usage and validate channel names before
      subscribing:

      ```js

      if (!isAllowedChannel($CHANNEL_NAME)) {
        throw new Error('Unauthorized diagnostics channel');
      }

      ```
